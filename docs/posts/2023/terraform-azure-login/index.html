<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Terraform Azure - Login and remote state | virture.de - just a blog</title><meta name=keywords content="terraform,azure"><meta name=description content="How to login to azue for terrafrom deployments"><meta name=author content="Michael"><link rel=canonical href=https://www.virture.de/posts/2023/terraform-azure-login/><link crossorigin=anonymous href=/assets/css/stylesheet.1f28a8812024f3d082361c1abf7913baf83dd8b4bbf6c1463b9dbf1bb0c2d81d.css integrity="sha256-HyiogSAk89CCNhwav3kTuvg92LS79sFGO52/G7DC2B0=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://www.virture.de/images/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.virture.de/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.virture.de/favicon-32x32.png><link rel=apple-touch-icon href=https://www.virture.de/apple-touch-icon.png><link rel=mask-icon href=https://www.virture.de/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="Terraform Azure - Login and remote state"><meta property="og:description" content="How to login to azue for terrafrom deployments"><meta property="og:type" content="article"><meta property="og:url" content="https://www.virture.de/posts/2023/terraform-azure-login/"><meta property="og:image" content="https://www.virture.de/images/img05.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-07-07T00:00:00+00:00"><meta property="article:modified_time" content="2023-07-07T00:00:00+00:00"><meta property="og:site_name" content="virture"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.virture.de/images/img05.png"><meta name=twitter:title content="Terraform Azure - Login and remote state"><meta name=twitter:description content="How to login to azue for terrafrom deployments"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://www.virture.de/posts/"},{"@type":"ListItem","position":3,"name":"Terraform Azure - Login and remote state","item":"https://www.virture.de/posts/2023/terraform-azure-login/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Terraform Azure - Login and remote state","name":"Terraform Azure - Login and remote state","description":"How to login to azue for terrafrom deployments","keywords":["terraform","azure"],"articleBody":"CLI Login to azure for Terraform deployments Introduction In this article, we’ll explore the process of logging in to Azure for Terraform deployments and managing remote state. When working with Terraform to provision infrastructure in Azure, it’s crucial to establish a secure and authenticated connection to your Azure account.\nWe’ll start by discussing the steps to log in to Azure using the az login command. This command will prompt you to authenticate with your Azure credentials, allowing you to access and manage your Azure resources within your Terraform configuration.\nNext, we’ll delve into managing remote state in Terraform. If you have a tfstate file in a different subscription, resource group, or storage account, we’ll guide you through the process of exporting the necessary environment variable, ARM_ACCESS_KEY. This variable ensures that Terraform can authenticate and access the remote state file properly.\nBy following the instructions outlined in this guide, you’ll be able to log in to Azure for your Terraform deployments and seamlessly manage remote state, even if your tfstate file resides in a different subscription.\nRemark This approach should only be used for local development e.g via vscode and should not be used for CI/CD pipelines due to security risks\nHow to login to azure az login Set correct subscription az account set --subscription $SUBSCRIPTION_NAME If you have a tfstate in different subscription If you have an tfstate file in different subscriptio, resource group, or storage account you have to export the following environment variable:\nexport ARM_ACCESS_KEY=$(az storage account keys list --resource-group $RESGROUP --account-name $STORAGE_ACCOUNT_NAME --subscription $SUBSCRIPTION --query '[0].value' -o tsv) After this terraform init shoud work properly.\n","wordCount":"268","inLanguage":"en","image":"https://www.virture.de/images/img05.png","datePublished":"2023-07-07T00:00:00Z","dateModified":"2023-07-07T00:00:00Z","author":{"@type":"Person","name":"Michael"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.virture.de/posts/2023/terraform-azure-login/"},"publisher":{"@type":"Organization","name":"virture.de - just a blog","logo":{"@type":"ImageObject","url":"https://www.virture.de/images/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://www.virture.de accesskey=h title="Home (Alt + H)"><img src=https://www.virture.de/images/robot.png alt aria-label=logo height=35>Home</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://www.virture.de/posts title=blog><span>blog</span></a></li><li><a href=https://www.virture.de/categories/ title=categories><span>categories</span></a></li><li><a href=https://www.virture.de/tags/ title=tags><span>tags</span></a></li><li><a href=https://www.virture.de/archives title=archive><span>archive</span></a></li><li><a href=https://www.virture.de/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://www.virture.de/about/ title=about><span>about</span></a></li><li><a href=https://www.virture.de/imprint/ title=imprint><span>imprint</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://www.virture.de>Home</a>&nbsp;»&nbsp;<a href=https://www.virture.de/posts/>Posts</a></div><h1 class=post-title>Terraform Azure - Login and remote state</h1><div class=post-description>How to login to azue for terrafrom deployments</div><div class=post-meta><span title='2023-07-07 00:00:00 +0000 UTC'>July 7, 2023</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;268 words&nbsp;·&nbsp;Michael</div></header><figure class=entry-cover><img loading=lazy src=https://www.virture.de/images/img05.png alt></figure><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a><ul><li><a href=#remark>Remark</a></li><li><a href=#how-to-login-to-azure>How to login to azure</a></li><li><a href=#set-correct-subscription>Set correct subscription</a></li><li><a href=#if-you-have-a-tfstate-in-different-subscription>If you have a tfstate in different subscription</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h1 id=cli-login-to-azure-for-terraform-deployments>CLI Login to azure for Terraform deployments<a hidden class=anchor aria-hidden=true href=#cli-login-to-azure-for-terraform-deployments>#</a></h1><h2 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h2><p>In this article, we&rsquo;ll explore the process of logging in to Azure for Terraform deployments and managing remote state. When working with Terraform to provision infrastructure in Azure, it&rsquo;s crucial to establish a secure and authenticated connection to your Azure account.</p><p>We&rsquo;ll start by discussing the steps to log in to Azure using the az login command. This command will prompt you to authenticate with your Azure credentials, allowing you to access and manage your Azure resources within your Terraform configuration.</p><p>Next, we&rsquo;ll delve into managing remote state in Terraform. If you have a tfstate file in a different subscription, resource group, or storage account, we&rsquo;ll guide you through the process of exporting the necessary environment variable, ARM_ACCESS_KEY. This variable ensures that Terraform can authenticate and access the remote state file properly.</p><p>By following the instructions outlined in this guide, you&rsquo;ll be able to log in to Azure for your Terraform deployments and seamlessly manage remote state, even if your tfstate file resides in a different subscription.</p><h3 id=remark>Remark<a hidden class=anchor aria-hidden=true href=#remark>#</a></h3><p>This approach should only be used for local development e.g via vscode and should <em>not</em> be used for CI/CD pipelines due to security risks</p><h3 id=how-to-login-to-azure>How to login to azure<a hidden class=anchor aria-hidden=true href=#how-to-login-to-azure>#</a></h3><pre tabindex=0><code>az login
</code></pre><h3 id=set-correct-subscription>Set correct subscription<a hidden class=anchor aria-hidden=true href=#set-correct-subscription>#</a></h3><pre tabindex=0><code>az account set --subscription $SUBSCRIPTION_NAME
</code></pre><h3 id=if-you-have-a-tfstate-in-different-subscription>If you have a tfstate in different subscription<a hidden class=anchor aria-hidden=true href=#if-you-have-a-tfstate-in-different-subscription>#</a></h3><p>If you have an tfstate file in different subscriptio, resource group, or storage account you have to
export the following environment variable:</p><pre tabindex=0><code>export ARM_ACCESS_KEY=$(az storage account keys list --resource-group $RESGROUP --account-name $STORAGE_ACCOUNT_NAME --subscription $SUBSCRIPTION --query &#39;[0].value&#39; -o tsv)
</code></pre><p>After this terraform init shoud work properly.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://www.virture.de/tags/terraform/>terraform</a></li><li><a href=https://www.virture.de/tags/azure/>azure</a></li></ul><nav class=paginav><a class=prev href=https://www.virture.de/posts/2023/reset-vscode/><span class=title>« Prev</span><br><span>Reset VSCode</span></a>
<a class=next href=https://www.virture.de/posts/2023/linux-shell-special-chars/><span class=title>Next »</span><br><span>Special Chars in a Linux Shell</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://www.virture.de>virture.de - just a blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>